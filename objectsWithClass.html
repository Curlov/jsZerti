<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Objekte durch Klassen erstellen</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="box">
        <table id="table">
            <tr style="min-height: 20%; height: 20%;">
                <td
                    style="min-width: 15%; max-width: 15%;width: 15%; font-style: italic; font-weight: bold; font-size: xx-large; text-align: center;border-bottom: 1px solid black; ">
                    <p id="number">
                        #01
                    </p>
                </td>
                <td colspan="2"
                    style="min-width: 85%; max-width: 85%; width: 85%; font-weight: bold; font-size: large; border-bottom: 1px solid black;">
                    <p id="question">
                        p question
                    </p>
                </td>
            </tr>
            <tr>
                <td style="text-align: center">
                    <input type="checkbox" id="checkboxA" class="checkmark">
                </td>
                <td colspan="2">
                    <label for="checkboxA" id="answerA">
                        label answerA
                    </label>
                </td>
            </tr>
            <tr>
                <td style="text-align: center">
                    <input type="checkbox" id="checkboxB" class="checkmark">
                </td>
                <td colspan="2">
                    <label for="checkboxB" id="answerB">
                        label answerB
                    </label>
                </td>
            </tr>
            <tr>
                <td style="text-align: center">
                    <input type="checkbox" id="checkboxC" class="checkmark">
                </td>
                <td colspan="2">
                    <label for="checkboxC" id="answerC">
                        label answerC
                    </label>
                </td>
            </tr>
            <tr>
                <td style="text-align: center; border-bottom: 1px solid black;">
                    <input type="checkbox" id="checkboxD" class="checkmark">
                </td>
                <td colspan="2" style="border-bottom: 1px solid black;">
                    <label for="checkboxD" id="answerD">
                        label answerD
                    </label>
                </td>
            </tr>
            <tr style="min-height: 20%; height: 20%;">
                <td colspan="3" style="min-width: 100%; width: 100%; text-align: center;">
                    <button onclick="">back</button>
                    <button onclick="">check</button>
                    <button onclick="window.forward()">forward</button>
                </td>
            </tr>
        </table>
    </div>

    <script type="module">

        import {CardPool} from "./js/classes/CardPool.js";
        import {CardBox} from './js/classes/CardBox.js';
        import {cards} from './js/data/cards.js';

        const loadCardsFromPool = (start, end) => {
            // Sanitize user input to avoid invalid data
            start = Math.max(1, start); // Ensure start is at least 1
            end = Math.min(cards.length, end); // Ensure end is at most cards.length
            // Create CardPool and load each card from data.js
            const cardPool = new CardPool();
            cards.forEach(card => cardPool.loadCard(card));

            // Create CardBox object and load selected cards from the pool
            const cardBox = new CardBox(1);
            cardBox.loadCards(cardPool.cards.slice(start - 1, end));

            return cardBox;
        }

        // Show the current Card into the DOM
        const showCard = (currentCard) => {
            document.querySelector('#number').innerHTML = '#'+cardBox.cards.find(card => Number(card.id) === Number(currentCard)).id;
            document.querySelector('#question').innerHTML = cardBox.cards.find(card => Number(card.id) === Number(currentCard)).question || 'Keine Frage gefunden';
            document.querySelector('#answerA').innerHTML = cardBox.cards.find(card => Number(card.id) === Number(currentCard)).answers[0].text || 'Keine Antwort gefunden';
            document.querySelector('#answerB').innerHTML = cardBox.cards.find(card => Number(card.id) === Number(currentCard)).answers[1].text || 'Keine Antwort gefunden';
            document.querySelector('#answerC').innerHTML = cardBox.cards.find(card => Number(card.id) === Number(currentCard)).answers[2].text || 'Keine Antwort gefunden';
            document.querySelector('#answerD').innerHTML = cardBox.cards.find(card => Number(card.id) === Number(currentCard)).answers[3].text || 'Keine Antwort gefunden';
        }

        window.forward = function() {
            cardBox.getNextCard();
            showCard(cardBox.getCurrentIndex());
            console.log('Bin hier' + cardBox.getCurrentIndex());
        }

        // If start and end positions are given in the GET params from select.html, use them 
        // to choose cards from the pool. Otherwise, default to the first 10 cards
        const params = new URLSearchParams(window.location.search);
        const start = params.get('start') || 1; // Default to 1 if no start param
        const end = params.get('end') || 10;   // Default to 10 if no end param
        const cardBox = loadCardsFromPool(start, end);
        cardBox.setCurrentIndex(start);

        console.log(cardBox);

        // console.log(cardBox.cards[5].answers[2].text);

        showCard(cardBox.getCurrentIndex());




    </script>
</body>

</html>
